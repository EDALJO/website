{% extends "page.html" %}
{% block title %}{{ this.title }}{% endblock %}

{% block htmlheader %}
<script type="text/javascript">
// Sets the display style of all currently selected dictionaries to BLOCK, and
// all others to NONE.
function showDictionaries(e, platform) {
    // Get the currently selected language from the SELECT object in the body
    // (the function is called from there, with 'e' as the argument)
    var selectedLang = e.options[e.selectedIndex].value;
    // Query all elements that are marked with the dict-entry class name
    var allEntries = document.querySelectorAll('.' + platform);

    var cnt;
    for (cnt = 0; cnt < allEntries.length; cnt++) {
        // Set display to block or none based on whether the element is marked
        // with a class name dict-(src|trg)-eng, dict-(src|trg)-deu, ... depending on the
        // selected language
        var clname = allEntries[cnt].className.split(' ');
        if(clname.includes("dict-src-" + selectedLang) ||
                clname.includes("dict-trg-" + selectedLang)) {

            allEntries[cnt].style.display = "block";
        } else {
            allEntries[cnt].style.display = "none";
        }
    }
}
</script>
{% endblock %}

{% block body %}
<h2>{{ _("Table Of Contents") }}</h2>
{# TOC needs to be built manually, since plugin doesn't know our additional
   blocks #}
<h2>{{ _("Table Of Contents") }}</h2>
<ul class="toc">
    {% for item in this.body.toc + this.after_mobile.toc + this.after_desktop.toc + this.after_source.toc recursive %}
      <li><a href="#{{ item.anchor }}">{{ item.title }}</a>{%
             if item.children %}<ul>{{ loop(item.children) }}</ul>{% endif
             %}</li>
      {% endfor %}
</ul>

  {{ super() }}

{{ generate_download_section('mobile') }}

{{ this.after_mobile }}

{{ generate_download_section('desktop') }}

{% block after_desktop %} {{ this.after_desktop }} {% endblock %}

{{ generate_download_section('source') }}

{% block after_source %} {{ this.after_source }} {% endblock %}
{% endblock %}
